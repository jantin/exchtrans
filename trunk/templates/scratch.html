{% extends "adminBase.html" %}{% block extrahead %}
<script type="text/javascript" src="/site_media/scripts/jquery/jquery.pack.js"></script>
<script src="/site_media/scripts/jquery/jquery.alphanumeric.pack.js" type="text/javascript" ></script>

<style type="text/css">



</style>
<script type="text/javascript">
	$(document).ready(
		function(){
			// Bind the input fields of the offerFormulation screen
			// Updates the "This deal would get you" number on the offerFormulation screen
			$('.offerFormulationInputs').numeric();
			$(".offerFormulationInputs").keyup(function(){
				offerFormulationProcessInput();
			});
			$("#offerFormulationOfferUnit").change(function(){
				offerFormulationProcessInput();
			});
			$("#offerFormulationRequestUnit").change(function(){
				offerFormulationProcessInput();
			});
		}
	);
	
	// Updates the "This deal would get you" number on the offerFormulation screen
	// Called on keyup of the input fields of the offerFormulation screen
	function offerFormulationProcessInput(){		
		// Clear the error if present
		$("#offerFormulationOfferError").html("");
		

		// Set up all our working variables
		offer = $("#offerFormulationOffer").val();
		request = $("#offerFormulationRequest").val();
		offerUnit = $("#offerFormulationOfferUnit").val();
		requestUnit = $("#offerFormulationRequestUnit").val();
		availableX = $("#startingX").val();
		availableY = $("#startingY").val();
		xValue = $("#valueX").val();
		yValue = $("#valueY").val();
				
		// Calculate the current number of points held by the player this round
		initialPoints = (availableX * xValue) + (availableY * yValue);
		
		// Calculate the loss from offering
		if(offerUnit == "x"){
			// Check that the input value is not beyond the available amount
			if(parseInt(offer) > parseInt(availableX)) {
				offer = availableX;
				$("#offerFormulationOffer").val(offer);
				$("#offerFormulationOfferError").html("You only have " + availableX + " " + offerUnit);
			}
			loss = offer * xValue;
		} else {
			// Check that the input value is not beyond the available amount
			if(parseInt(offer) > parseInt(availableY)) {
				offer = availableY;
				$("#offerFormulationOffer").val(offer);
				$("#offerFormulationOfferError").html("You only have " + availableY + " " + offerUnit);
			}
			loss = offer * yValue;
		}
		
		// Calculate the potential gain from the request
		if(requestUnit == "x"){
			gain = request * xValue;
		} else {
			gain = request * yValue;
		}
		
		// calculate the potential points
		pointsPreview = initialPoints + (gain - loss);		
		
		// Display the preview points
		$("#offerFormulationPoints").html(pointsPreview);
	}
</script>

{% endblock %}{% block bodyid %}tab2{% endblock %}{% block sectionDivID %}editor{% endblock %}{% block adminContent %}


<div id="valuePreview" class="valuePreviewDialog" title="Use this form to check your values" >

<h3>Starting Values</h3>
X: <input type="text" name="startingX" value="10" size="4" id="startingX" class="offerFormulationInputs"/>  
Y: <input type="text" name="startingY" value="10" size="4" id="startingY" class="offerFormulationInputs"/>
<br/><br/>
<h3>Offer Setup</h3>
What will you give?
<p>
	<input type="text" name="offerFormulationOffer" id="offerFormulationOffer" class="offerFormulationInputs" value="0" size="4"/>
	<select name="offerFormulationOfferUnit" id="offerFormulationOfferUnit">
		<option>x</option>
		<option>y</option>
	</select>
	<span id="offerFormulationOfferError" class="offerFormulationError"></span>
</p>
<p>What do you want in return?</p>
<p>
	<input type="text" name="offerFormulationRequest" id="offerFormulationRequest" class="offerFormulationInputs" value="0" size="4"/>
	<select name="offerFormulationRequestUnit" id="offerFormulationRequestUnit">
		<option>y</option>
		<option>x</option>
	</select>
</p>

<h3>Value Formulas</h3>
X: <input type="text" name="valueX" value="10" size="20" id="valueX" class="offerFormulationInputs"/>  
Y: <input type="text" name="valueY" value="10" size="20" id="valueY" class="offerFormulationInputs"/>
<br/><br/>
<h3>Point Value</h3>
<p>This deal would yield: <b><span id="offerFormulationPoints">0</span></b> points</p>

</div>

{% endblock %}
